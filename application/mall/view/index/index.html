<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>商城首页</title>
    <script>
        (function (designWidth, maxWidth) {
            var doc = document,
                win = window;
            var docEl = doc.documentElement;
            var metaEl,
                metaElCon;
            var styleText,
                remStyle = document.createElement("style");
            var tid;

            function refreshRem() {
                // var width = parseInt(window.screen.width); // uc有bug
                var width = docEl.getBoundingClientRect().width;
                if (!maxWidth) {
                    maxWidth = 540;
                };
                if (width > maxWidth) { // 淘宝做法：限制在540的屏幕下，这样100%就跟10rem不一样了
                    width = maxWidth;
                }
                var rem = width * 100 / designWidth;
                // var rem = width / 10; // 如果要兼容vw的话分成10份 淘宝做法
                //docEl.style.fontSize = rem + "px"; //旧的做法，在uc浏览器下面会有切换横竖屏时定义了font-size的标签不起作用的bug
                remStyle.innerHTML = 'html{font-size:' + rem + 'px;}';
            }

            // 设置 viewport ，有的话修改 没有的话设置
            metaEl = doc.querySelector('meta[name="viewport"]');
            // 20171219修改：增加 viewport-fit=cover ，用于适配iphoneX
            metaElCon = "width=device-width,initial-scale=1,maximum-scale=1.0,user-scalable=no,viewport-fit=cover";
            if (metaEl) {
                metaEl.setAttribute("content", metaElCon);
            } else {
                metaEl = doc.createElement("meta");
                metaEl.setAttribute("name", "viewport");
                metaEl.setAttribute("content", metaElCon);
                if (docEl.firstElementChild) {
                    docEl.firstElementChild.appendChild(metaEl);
                } else {
                    var wrap = doc.createElement("div");
                    wrap.appendChild(metaEl);
                    doc.write(wrap.innerHTML);
                    wrap = null;
                }
            }

            //要等 wiewport 设置好后才能执行 refreshRem，不然 refreshRem 会执行2次；
            refreshRem();

            if (docEl.firstElementChild) {
                docEl.firstElementChild.appendChild(remStyle);
            } else {
                var wrap = doc.createElement("div");
                wrap.appendChild(remStyle);
                doc.write(wrap.innerHTML);
                wrap = null;
            }

            win.addEventListener("resize", function () {
                clearTimeout(tid); //防止执行两次
                tid = setTimeout(refreshRem, 300);
            }, false);

            win.addEventListener("pageshow", function (e) {
                if (e.persisted) { // 浏览器后退的时候重新计算
                    clearTimeout(tid);
                    tid = setTimeout(refreshRem, 300);
                }
            }, false);

            if (doc.readyState === "complete") {
                doc.body.style.fontSize = "16px";
            } else {
                doc.addEventListener("DOMContentLoaded", function (e) {
                    doc.body.style.fontSize = "16px";
                }, false);
            }
        })(750, 750);
    </script>
    <link rel="stylesheet" href="__STATIC__/css/main.css?v=1.0">
    <link rel="stylesheet" href="__STATIC__/css/common.css">

</head>

<body>
    <section>
        <figure id="full_feature" class="swipslider">
            <ul class="sw-slides">
                {foreach name="bannerList" item="item"}
                <li class="sw-slide">
                    <a href="{if condition=" $item.ad_link !='' "}{$item.ad_link}{else/}javascript:;{/if}">
                        <img src="{$item.ad_code}" alt="">
                    </a>
                </li>
                {/foreach}
            </ul>
        </figure>
    </section>

    <ul class="order-wrap">
        <li {if $cat_id=='' }class="active" {/if} onclick="window.location='{:U('mall/index/index')}'">热销</li>
        {foreach name="categoryList" item="category"}
        <li {if $cat_id==$category.id}class="active" {/if} onclick="window.location='{:U('mall/index/index', array('cat_id'=>$category.id))}'">{$category.name}</li>
        {/foreach}
    </ul>

    <ul class="content-list">
        <li class="item hot">
            <ul>
                {foreach name="list" item="goods"}
                <li onclick="window.location='{:U('mall/goods/goodsInfo', array('id'=>$goods.goods_id))}'">
                    <div class="poster-wrapper">
                        <img src="{$goods.original_img}" alt="">
                    </div>
                    <p>{$goods.goods_name}</p>
                    <div class="price-wrap">
                        <div>￥<span class="price">{$goods.shop_price}</span> <del>￥ <span class="before-price">{$goods.market_price}</span>
                            </del> </div>
                        <!-- <i class="icon-addpay"></i> -->
                    </div>
                </li>
                {/foreach}
            </ul>
        </li>
    </ul>
    {include file="public/footer_nav"}

    <script src="__STATIC__/js/jquery.js"></script>
    <script src="__STATIC__/js/poster.js"></script>
    <script type="text/javascript">
        $(function () {
            $('#full_feature').swipeslider();
            $('#content_slider').swipeslider({
                transitionDuration: 600,
                autoPlayTimeout: 10000,
                sliderHeight: '300px'
            });
            $('#responsiveness').swipeslider();
            $('#customizability').swipeslider({
                transitionDuration: 1500,
                autoPlayTimeout: 4000,
                timingFunction: 'cubic-bezier(0.38, 0.96, 0.7, 0.07)',
                sliderHeight: '30%'
            });
        });
    </script>
</body>

</html>